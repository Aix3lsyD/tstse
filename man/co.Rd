% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/co.R
\name{co}
\alias{co}
\title{Cochrane-Orcutt Estimation for Trend with Correlated Errors}
\usage{
co(
  x,
  maxp = 5L,
  method = c("burg", "mle", "yw"),
  type = c("aic", "aicc", "bic"),
  iterate = FALSE,
  max_iter = 50L,
  tol = 1e-06
)
}
\arguments{
\item{x}{A numeric vector containing the time series data.}

\item{maxp}{Maximum AR order for model selection. Default is 5.}

\item{method}{Character. Method for AR estimation: \code{"mle"}, \code{"burg"},
or \code{"yw"}. Default is \code{"burg"}.}

\item{type}{Character. Information criterion for order selection:
\code{"aic"}, \code{"aicc"}, or \code{"bic"}. Default is \code{"aic"}.}

\item{iterate}{Logical. If \code{TRUE}, iterates by re-estimating AR coefficients
from Cochrane-Orcutt residuals until convergence. If \code{FALSE} (default),
performs a single-pass estimation.}

\item{max_iter}{Integer. Maximum iterations for iterative method.
Default is 50. Only used when \code{iterate = TRUE}.}

\item{tol}{Numeric. Convergence tolerance for phi in iterative method.
Default is 1e-6. Iteration stops when max|phi_new - phi_old| < tol.}
}
\value{
A list containing:
\item{x}{The original time series.}
\item{z_x}{Residuals from initial OLS trend fit.}
\item{b0hat}{Cochrane-Orcutt estimate of intercept.}
\item{b1hat}{Cochrane-Orcutt estimate of slope.}
\item{z_order}{AR order selected for the residuals.}
\item{z_phi}{AR coefficients for the residual model.}
\item{pvalue}{P-value for test of H0: slope = 0 (assumes uncorrelated
transformed residuals; use \code{\link[=wbg_boot]{wbg_boot()}} for more accurate
p-values with correlated errors).}
\item{tco}{t-statistic for the slope coefficient.}
\item{method}{The AR estimation method used.}
}
\description{
Estimates linear trend in time series data with autocorrelated residuals
using the Cochrane-Orcutt procedure. The residuals are modeled as an AR(p)
process with order selected by information criterion.
}
\details{
Fits the model
\deqn{Y_t = a + bt + Z_t}
where \eqn{Z_t} is a stationary AR(p) process satisfying
\eqn{\phi(B)Z_t = a_t}.

The procedure:
\enumerate{
\item Obtains OLS estimates of \eqn{a} and \eqn{b}
\item Computes residuals and fits AR(p) via the specified method with
information criterion order selection
\item Transforms the data using \eqn{\hat{\phi}(B)} to obtain
\eqn{W_t = \hat{\phi}(B)Y_t}
\item Regresses \eqn{W_t} on the transformed time index
\item (If \code{iterate = TRUE}) Re-estimates AR from CO residuals and repeats
steps 3-4 until convergence
}

Note: The p-value returned assumes the transformed residuals are
uncorrelated, which is only approximate. For small to moderate sample sizes
with highly correlated errors, use \code{\link[=wbg_boot]{wbg_boot()}} for bootstrap-based
inference with better significance level control.
}
\examples{
# Generate series with trend and AR(1) errors
set.seed(123)
n <- 100
t <- 1:n
z <- arima.sim(list(ar = 0.7), n = n)
x <- 5 + 0.1 * t + z

# Estimate trend with Cochrane-Orcutt
result <- co(x, maxp = 5)
cat("Slope estimate:", result$b1hat, "\n")
cat("t-statistic:", result$tco, "\n")
cat("AR order:", result$z_order, "\n")

}
\references{
Cochrane, D. and Orcutt, G. H. (1949). "Application of Least Squares
Regression to Relationships Containing Auto-Correlated Error Terms."
\emph{Journal of the American Statistical Association}, 44(245), 32-61.

Woodward, W. A., Bottone, S., and Gray, H. L. (1997). "Improved Tests for
Trend in Time Series Data." \emph{Journal of Agricultural, Biological, and
Environmental Statistics}, 2(4), 403-416.
}
\seealso{
\code{\link[=wbg_boot]{wbg_boot()}} for bootstrap-based trend test,
\code{\link[=aic_ar]{aic_ar()}}, \code{\link[=artrans]{artrans()}}
}
