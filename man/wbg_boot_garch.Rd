% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/wbg_boot_garch.R
\name{wbg_boot_garch}
\alias{wbg_boot_garch}
\alias{print.wbg_boot_garch}
\alias{summary.wbg_boot_garch}
\title{WBG Bootstrap Test for Trend with GARCH Errors}
\usage{
wbg_boot_garch(
  x,
  stat_fn = make_stat_co(),
  nb = 399L,
  p_max = 5L,
  criterion = c("aic", "aicc", "bic"),
  distribution = "norm",
  stationary_check = c("warn", "error", "none"),
  bootadj = FALSE,
  cores = 1L,
  seed = NULL,
  verbose = TRUE
)

\method{print}{wbg_boot_garch}(x, ...)

\method{summary}{wbg_boot_garch}(object, ...)
}
\arguments{
\item{x}{A wbg_boot_garch object}

\item{stat_fn}{Function. A function that takes a numeric vector and returns
a single numeric test statistic. Use factory functions like
\code{\link[=make_stat_co]{make_stat_co()}}, \code{\link[=make_stat_ols_t]{make_stat_ols_t()}}, etc., or create your own with
signature \verb{function(x) -> numeric(1)}.}

\item{nb}{Integer. Number of bootstrap replicates. Default is 399.}

\item{p_max}{Integer. Maximum AR order to consider when fitting the null
model. Order is selected by information criterion. Default is 5.}

\item{criterion}{Character. Information criterion for AR order selection:
\code{"aic"} (default), \code{"aicc"}, or \code{"bic"}.}

\item{distribution}{Character. Innovation distribution for GARCH model.
Options include \code{"norm"} (default), \code{"std"} (Student's t), \code{"ged"},
\code{"snorm"}, \code{"sstd"}, \code{"sged"}, \code{"nig"}, \code{"jsu"}.}

\item{stationary_check}{Character. How to handle non-stationary AR fits:
\code{"warn"} (default) issues a warning, \code{"error"} stops execution,
\code{"none"} skips the check.}

\item{bootadj}{Logical. If TRUE, performs the COBA (Cochrane-Orcutt
Bootstrap Adjustment) variance adjustment. Default is FALSE because
fitting GARCH to each bootstrap sample is computationally expensive.}

\item{cores}{Integer or NULL. Number of CPU cores for parallel processing.
Default 1 (sequential). Set to 0 to use all available cores.}

\item{seed}{Integer or NULL. Random seed for reproducibility.}

\item{verbose}{Logical. If TRUE (default), display progress messages.}

\item{...}{Additional arguments (ignored)}

\item{object}{A wbg_boot_garch object}
}
\value{
An object of class \code{"wbg_boot_garch"} containing:
\item{obs_stat}{Observed test statistic.}
\item{boot_dist}{Vector of bootstrap statistics.}
\item{pvalue}{Two-sided p-value.}
\item{pvalue_upper}{Upper-tail p-value.}
\item{pvalue_lower}{Lower-tail p-value.}
\item{ar_order}{Selected AR order under null.}
\item{garch_order}{GARCH order (fixed at c(1,1)).}
\item{ar_coef}{AR coefficients under null.}
\item{garch_coef}{GARCH coefficients (omega, alpha1, beta1).}
\item{distribution}{Innovation distribution used.}
\item{n}{Sample size.}
\item{nb}{Number of bootstrap replicates.}
\item{ic}{Information criterion value of selected model.}

If \code{bootadj = TRUE}, also includes:
\item{obs_stat_adj}{COBA-adjusted observed statistic.}
\item{pvalue_adj}{COBA-adjusted two-sided p-value.}
\item{adj_factor}{Variance adjustment factor.}
\item{median_coef}{Median AR-GARCH coefficients from first stage.}
}
\description{
Performs a bootstrap hypothesis test for trend in a time series with
heteroscedastic (GARCH) errors. The null model is AR(p) + GARCH(1,1),
which accounts for volatility clustering while testing for trend.
}
\details{
This function extends the Woodward-Bottone-Gray (WBG) bootstrap test for
trend to handle heteroscedastic errors. The null hypothesis is that the
series is AR(p) + GARCH(1,1) with no trend.

\strong{Procedure:}
\enumerate{
\item Compute the observed test statistic \code{stat_fn(x)}
\item Fit AR(p) + GARCH(1,1) models for p = 0, ..., p_max via rugarch
\item Select best p by information criterion (joint model selection)
\item Generate \code{nb} bootstrap series from the fitted model using
\code{rugarch::ugarchpath()}
\item Compute test statistic for each bootstrap series
\item Calculate p-value as proportion of |bootstrap stat| >= |observed stat|
}

\strong{AR Order Selection:}
Unlike \code{\link[=wbg_boot_flex]{wbg_boot_flex()}}, which selects AR order from a pure AR model,
this function fits the full AR(p) + GARCH(1,1) model for each candidate
order and selects based on the joint model's information criterion.

\strong{Stationarity:}
The AR model must be stationary for bootstrap samples to be well-behaved.
rugarch does not enforce AR stationarity by default. Use \code{stationary_check}
to control behavior when non-stationary fits are detected.
}
\section{Methods (by generic)}{
\itemize{
\item \code{print(wbg_boot_garch)}: Print method for wbg_boot_garch objects

\item \code{summary(wbg_boot_garch)}: Summary method for wbg_boot_garch objects

}}
\examples{
\donttest{
if (requireNamespace("rugarch", quietly = TRUE)) {
  # Test for trend in white noise (should not reject)
  set.seed(123)
  x <- rnorm(200)
  stat_fn <- make_stat_co()
  result <- wbg_boot_garch(x, stat_fn, nb = 99, seed = 456, verbose = FALSE)
  print(result)

  # Test for trend in series with actual trend (should reject)
  set.seed(123)
  x_trend <- 0.1 * (1:200) + arima.sim(list(ar = 0.7), n = 200)
  result <- wbg_boot_garch(x_trend, stat_fn, nb = 99, seed = 456, verbose = FALSE)
  result$pvalue  # Should be small
}
}

}
\references{
Woodward, W. A., Bottone, S., and Gray, H. L. (1997). "Improved Tests for
Trend in Time Series Data." \emph{Journal of Agricultural, Biological, and
Environmental Statistics}, 2(4), 403-416.
}
\seealso{
\code{\link[=wbg_boot_flex]{wbg_boot_flex()}} for the pure AR version,
\code{\link[=make_stat_co]{make_stat_co()}} and other statistic factory functions,
\code{\link[=compare_garch]{compare_garch()}} for GARCH model comparison.
}
