% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/kalman.R
\name{kalman}
\alias{kalman}
\title{Kalman Filter and Smoother}
\usage{
kalman(y, x0, P0, Phi, Q, A, R)
}
\arguments{
\item{y}{Numeric vector. The observed time series data.}

\item{x0}{Numeric scalar or vector. Initial state estimate (prior mean of
the state at time 0).}

\item{P0}{Numeric scalar or matrix. Initial state covariance (prior
variance/covariance of the state at time 0).}

\item{Phi}{Numeric scalar or matrix. State transition matrix (F in some
notations). Describes how the state evolves: \eqn{x_t = \Phi x_{t-1} + v_t}.}

\item{Q}{Numeric scalar or matrix. State noise variance (process noise
covariance). The variance of \eqn{v_t}.}

\item{A}{Numeric scalar or matrix. Observation matrix (G or H in some
notations). Relates state to observations: \eqn{y_t = A x_t + w_t}.}

\item{R}{Numeric scalar or matrix. Observation noise variance (measurement
noise covariance). The variance of \eqn{w_t}.}
}
\value{
A list with class \code{"kalman"} containing:
\item{y}{The original observations.}
\item{predicted}{List with \code{state} (predicted state estimates) and
\code{var} (predicted state variances).}
\item{filtered}{List with \code{state} (filtered state estimates) and
\code{var} (filtered state variances).}
\item{smoothed}{List with \code{state} (smoothed state estimates) and
\code{var} (smoothed state variances).}
\item{result}{The raw output from \code{\link[astsa:Ksmooth]{astsa::Ksmooth()}} for advanced use.}
}
\description{
Performs Kalman filtering and smoothing for a linear Gaussian state-space
model. This is a convenience wrapper around \code{\link[astsa:Ksmooth]{astsa::Ksmooth()}}.
}
\details{
The function implements the Kalman filter and smoother for the linear
Gaussian state-space model:

\strong{State equation:}
\deqn{x_t = \Phi x_{t-1} + v_t, \quad v_t \sim N(0, Q)}

\strong{Observation equation:}
\deqn{y_t = A x_t + w_t, \quad w_t \sim N(0, R)}

The Kalman filter provides:
\itemize{
\item \strong{Prediction}: Estimate of \eqn{x_t} given \eqn{y_1, \ldots, y_{t-1}}
\item \strong{Filtering}: Estimate of \eqn{x_t} given \eqn{y_1, \ldots, y_t}
\item \strong{Smoothing}: Estimate of \eqn{x_t} given all data \eqn{y_1, \ldots, y_n}
}
}
\note{
This function requires the \code{astsa} package. Install it with
\code{install.packages("astsa")} if needed.
}
\examples{
\dontrun{
# Local level model (random walk + noise)
set.seed(123)
n <- 100

# True state is a random walk
x_true <- cumsum(rnorm(n, sd = 1))
# Observations are state + noise
y <- x_true + rnorm(n, sd = 2)

# Fit Kalman filter
result <- kalman(
  y = y,
  x0 = 0,           # Initial state guess
  P0 = 10,          # Initial state variance (uncertain)
  Phi = 1,          # Random walk: x_t = x_{t-1} + v_t
  Q = 1,            # State noise variance
  A = 1,            # Direct observation: y_t = x_t + w_t
  R = 4             # Observation noise variance
)

# Plot results
plot(y, type = "p", pch = 16, cex = 0.5, col = "gray")
lines(x_true, col = "black", lwd = 2)
lines(result$filtered$state, col = "blue", lwd = 2)
lines(result$smoothed$state, col = "red", lwd = 2)
legend("topleft", c("Observed", "True", "Filtered", "Smoothed"),
       col = c("gray", "black", "blue", "red"),
       pch = c(16, NA, NA, NA), lty = c(NA, 1, 1, 1), lwd = 2)
}

}
\references{
Shumway, R. H., & Stoffer, D. S. (2017). \emph{Time Series Analysis and Its
Applications: With R Examples} (4th ed.). Springer.
}
\seealso{
\code{\link[astsa:Ksmooth]{astsa::Ksmooth()}} for the underlying implementation,
\code{\link[=kalman_miss]{kalman_miss()}} for handling missing observations.
}
