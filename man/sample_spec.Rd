% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/sample_spec.R
\name{sample_spec}
\alias{sample_spec}
\title{Sample Spectral Density}
\usage{
sample_spec(x, db = TRUE, n_freq = 251L, plot = TRUE)
}
\arguments{
\item{x}{Numeric vector. The time series to analyze.}

\item{db}{Logical. If \code{TRUE} (default), return the spectral density in
decibels (dB), i.e., \eqn{10 \log_{10}(S(f))}. If \code{FALSE}, return the
raw spectral density.}

\item{n_freq}{Integer. Number of frequency points to evaluate. Default is
251, giving frequencies from 0 to 0.5 in increments of 0.002.}

\item{plot}{Logical. If \code{TRUE} (default), plot the spectral density.}
}
\value{
A list with class \code{"sample_spec"} containing:
\item{freq}{Numeric vector of frequencies (0 to 0.5).}
\item{spec}{Numeric vector of spectral density estimates at each frequency.}
\item{db}{Logical indicating whether \code{spec} is in decibels.}
}
\description{
Computes and optionally plots the sample spectral density (periodogram)
of a time series using the autocorrelation function.
}
\details{
The sample spectral density is computed from the sample autocorrelation
function using the formula:
\deqn{S(f) = 1 + 2 \sum_{k=1}^{n-1} \hat{\rho}_k \cos(2\pi f k)}

where \eqn{\hat{\rho}_k} is the sample autocorrelation at lag \eqn{k}.

This is the raw (unsmoothed) periodogram. For a smoothed estimate using
the Parzen window, see \code{\link[=parzen]{parzen()}}.
}
\section{Interpretation}{

\itemize{
\item Frequencies range from 0 (long-term trend) to 0.5 (Nyquist frequency)
\item Peaks indicate dominant periodicities in the data
\item The dB scale helps visualize differences across a wide range of values
}
}

\examples{
# White noise has flat spectrum
set.seed(123)
wn <- rnorm(200)
sample_spec(wn)

# AR(1) with positive phi has more power at low frequencies
ar1 <- arima.sim(model = list(ar = 0.8), n = 200)
sample_spec(ar1)

# Seasonal pattern shows peak at seasonal frequency
seasonal <- sin(2 * pi * (1:200) / 12) + rnorm(200, sd = 0.5)
sample_spec(seasonal)

# Non-dB scale
sample_spec(ar1, db = FALSE)

}
\seealso{
\code{\link[=parzen]{parzen()}} for smoothed spectral estimation,
\code{\link[=true_spec]{true_spec()}} for theoretical ARMA spectra,
\code{\link[stats:spectrum]{stats::spectrum()}} for R's built-in spectral analysis.
}
