% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/co_fast.R
\name{co_fast}
\alias{co_fast}
\title{Fast Cochrane-Orcutt Estimation Using C++ Primitives}
\usage{
co_fast(x, maxp = 5L, type = c("aic", "aicc", "bic"))
}
\arguments{
\item{x}{A numeric vector containing the time series data.}

\item{maxp}{Maximum AR order for model selection. Default is 5.}

\item{type}{Character. Information criterion for order selection:
\code{"aic"}, \code{"aicc"}, or \code{"bic"}. Default is \code{"aic"}.}
}
\value{
A list containing the same elements as \code{\link[=co]{co()}}:
\item{x}{The original time series.}
\item{z_x}{Residuals from initial OLS trend fit.}
\item{b0hat}{Cochrane-Orcutt estimate of intercept.}
\item{b1hat}{Cochrane-Orcutt estimate of slope.}
\item{z_order}{AR order selected for the residuals.}
\item{z_phi}{AR coefficients for the residual model.}
\item{pvalue}{P-value for test of H0: slope = 0.}
\item{tco}{t-statistic for the slope coefficient.}
\item{method}{Always "burg" (C++ implementation uses Burg algorithm).}
}
\description{
Optimized version of \code{\link[=co]{co()}} using C++ primitives for AR fitting and
transformation. Produces identical results to \code{co(..., method = "burg")}
but with significantly better performance.
}
\details{
This function uses C++ implementations for maximum performance:
\itemize{
\item AR fitting via \code{burg_aic_select_cpp()} (Burg algorithm with IC selection)
\item OLS detrending via \code{ols_detrend_cpp()}
\item AR transformation via \code{ar_transform_cpp()}
}

\strong{Important note on AR order selection}: \code{co_fast()} uses C++ Burg which
computes variance via the recursive formula \code{var(p) = var(0) * prod(1 - phii^2)},
while \code{co()} uses \code{aic_ar()} which computes variance from backcast residuals.
These methods can select different AR orders on some data, particularly on
white noise or near-white-noise series. On data with true AR structure, both
methods typically select the same order.

The only limitation is that \code{co_fast()} only supports the Burg method for
AR estimation. For MLE or Yule-Walker, use \code{\link[=co]{co()}}.
}
\examples{
# Generate series with trend and AR(1) errors
set.seed(123)
n <- 100
t <- 1:n
z <- arima.sim(list(ar = 0.7), n = n)
x <- 5 + 0.1 * t + z

# Compare co() and co_fast()
r1 <- co(x, maxp = 5, method = "burg")
r2 <- co_fast(x, maxp = 5)

# Results should be identical
all.equal(r1$tco, r2$tco)
all.equal(r1$pvalue, r2$pvalue)

}
\seealso{
\code{\link[=co]{co()}} for the original implementation with multiple AR methods,
\code{\link[=wbg_boot_fast]{wbg_boot_fast()}} for bootstrap-based trend test
}
