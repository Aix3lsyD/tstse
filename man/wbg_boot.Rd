% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/wbg_boot.R
\name{wbg_boot}
\alias{wbg_boot}
\title{WBG Bootstrap Test for Trend}
\usage{
wbg_boot(
  x,
  nb = 399L,
  maxp = 5L,
  method = c("burg", "mle", "yw"),
  type = c("aic", "aicc", "bic"),
  cores = 1L,
  seed = NULL
)
}
\arguments{
\item{x}{A numeric vector containing the time series data.}

\item{nb}{Number of bootstrap replicates. Default is 399.}

\item{maxp}{Maximum AR order for model selection. Default is 5.}

\item{method}{Character. Method for AR estimation: \code{"mle"}, \code{"burg"},
or \code{"yw"}. Default is \code{"burg"} (matches original tswge).}

\item{type}{Character. Information criterion for order selection:
\code{"aic"}, \code{"aicc"}, or \code{"bic"}. Default is \code{"aic"}.}

\item{cores}{Integer, number of cores for parallel processing.
Default NULL uses \code{getOption("tstse.cores", 1)}.
Set to 0 to use all available cores.}

\item{seed}{Integer, random seed for reproducibility. Default NULL.}
}
\value{
A list containing:
\item{p}{AR order selected for the series under null hypothesis.}
\item{phi}{AR coefficients for the null model.}
\item{pvalue}{Bootstrap p-value for trend test (two-sided).}
\item{tco_obs}{Observed t-statistic from Cochrane-Orcutt fit.}
\item{boot_tstats}{Numeric vector of bootstrap t-statistics.}
\item{nb}{Number of bootstrap replicates used.}
}
\description{
Bootstrap hypothesis test for trend in time series with autocorrelated
errors. Uses the Woodward-Bottone-Gray (WBG) method to test H0: slope = 0
when residuals follow an AR(p) process.
}
\details{
The WBG bootstrap test addresses the problem that standard t-tests for
trend are invalid when residuals are autocorrelated. The procedure:

\enumerate{
\item Fit Cochrane-Orcutt model to observed data, obtaining t-statistic
\item Fit AR(p) model to data under null hypothesis (no trend)
\item Generate \code{nb} bootstrap series from the fitted AR(p) model
\item For each bootstrap series, fit Cochrane-Orcutt and compute t-statistic
\item p-value = proportion of |bootstrap t| >= |observed t|
}

This provides a more accurate p-value than the asymptotic approximation
used in \code{\link[=co]{co()}}, especially for small to moderate sample sizes with
highly autocorrelated errors.
}
\examples{
# Test series with no trend (should be non-significant)
set.seed(123)
x <- arima.sim(list(ar = 0.7), n = 100)
result <- wbg_boot(x, nb = 99, seed = 456)
cat("p-value:", result$pvalue, "\n")

# Test series with trend (should be significant)
set.seed(123)
x_trend <- arima.sim(list(ar = 0.7), n = 100) + 0.1 * (1:100)
result <- wbg_boot(x_trend, nb = 99, seed = 456)
cat("p-value:", result$pvalue, "\n")

}
\references{
Woodward, W. A., Bottone, S., and Gray, H. L. (1997). "Improved Tests for
Trend in Time Series Data." \emph{Journal of Agricultural, Biological, and
Environmental Statistics}, 2(4), 403-416.
}
\seealso{
\code{\link[=co]{co()}} for Cochrane-Orcutt estimation,
\code{\link[=aic_ar]{aic_ar()}} for AR order selection.
}
