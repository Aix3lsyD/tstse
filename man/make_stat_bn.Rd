% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/stat_generators.R
\name{make_stat_bn}
\alias{make_stat_bn}
\title{Create Bloomfield-Nychka t-Statistic Function}
\usage{
make_stat_bn(order.max = NULL)
}
\arguments{
\item{order.max}{Integer or NULL. Maximum AR order for spectral
estimation via \code{\link[stats:spec.ar]{stats::spec.ar()}}. If NULL (default),
the order is selected automatically.}
}
\value{
A function that takes a numeric vector \code{x} and returns
the Bloomfield-Nychka t-statistic for the trend coefficient.
}
\description{
Creates a function that computes the Bloomfield-Nychka t-statistic,
which corrects the standard error for trend using a spectral estimate
of the long-run variance (spectral density at frequency zero).
}
\details{
The procedure:
\enumerate{
\item Fit OLS trend and extract residuals.
\item Estimate spectral density of residuals at frequency zero using
an AR model.
\item Compute corrected variance: \eqn{Var(\hat{\beta}) = 12 \cdot f(0) / n^3}.
\item Return \eqn{t = \hat{\beta} / \sqrt{Var(\hat{\beta})}}.
}
}
\examples{
stat_fn <- make_stat_bn(order.max = 10)

set.seed(123)
x <- 0.1 * (1:100) + arima.sim(list(ar = 0.7), n = 100)
stat_fn(x)  # Bloomfield-Nychka t-statistic

}
\references{
Bloomfield, P. and Nychka, D. (1992). Climate spectra and detecting
climate change. \emph{Climatic Change}, 21, 275-287.
}
\seealso{
\code{\link[=wbg_boot_flex]{wbg_boot_flex()}}, \code{\link[=make_stat_hac]{make_stat_hac()}}
}
