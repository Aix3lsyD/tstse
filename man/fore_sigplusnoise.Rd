% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/fore_sigplusnoise.R
\name{fore_sigplusnoise}
\alias{fore_sigplusnoise}
\title{Forecast Signal Plus Noise Model}
\usage{
fore_sigplusnoise(
  x,
  linear = TRUE,
  freq = 0,
  max_p = 5L,
  n_ahead = 10L,
  lastn = FALSE,
  method = "mle",
  alpha = 0.05,
  limits = TRUE,
  plot = TRUE
)
}
\arguments{
\item{x}{Numeric vector. The time series to forecast.}

\item{linear}{Logical. If \code{TRUE} (default), fit a linear trend as the signal.
If \code{FALSE}, fit a cosine function at the specified frequency.}

\item{freq}{Numeric. Frequency for the cosine signal when \code{linear = FALSE}.
Ignored when \code{linear = TRUE}. Default is 0.}

\item{max_p}{Integer. Maximum AR order to consider for the noise component.
Order is selected by AIC. Default is 5.}

\item{n_ahead}{Integer. Number of periods to forecast ahead. Default is 10.}

\item{lastn}{Logical. If \code{TRUE}, forecast the last \code{n_ahead} observations
(for model validation). If \code{FALSE} (default), forecast beyond the end of
the series.}

\item{method}{Character. Estimation method for AR model: \code{"mle"} (default),
\code{"burg"}, or \code{"yw"} (Yule-Walker).}

\item{alpha}{Numeric. Significance level for prediction intervals.
Default is 0.05 (95\% intervals).}

\item{limits}{Logical. If \code{TRUE} (default), compute and plot prediction
intervals.}

\item{plot}{Logical. If \code{TRUE} (default), plot the series and forecasts.}
}
\value{
A list with class \code{"fore_sigplusnoise"} containing:
\item{signal}{The fitted signal component (linear trend or cosine).}
\item{noise}{The noise component (residuals from signal).}
\item{phi}{AR coefficients for the noise model.}
\item{p}{AR order selected.}
\item{f}{Point forecasts.}
\item{ll}{Lower prediction limits.}
\item{ul}{Upper prediction limits.}
\item{resid}{Residuals from the AR model.}
\item{se}{Standard errors for forecasts.}
\item{wnv}{White noise variance estimate.}
\item{signal_coef}{Signal coefficients: for linear, \code{c(intercept, slope)};
for cosine, \code{c(intercept, cos_coef, sin_coef)}.}
}
\description{
Forecasts a time series modeled as a deterministic signal (linear trend or
cosine function) plus AR noise.
}
\details{
The model assumes:
\deqn{X_t = S_t + Z_t}
where \eqn{S_t} is a deterministic signal and \eqn{Z_t} is AR(p) noise.

For \code{linear = TRUE}:
\deqn{S_t = \beta_0 + \beta_1 t}

For \code{linear = FALSE}:
\deqn{S_t = \beta_0 + \beta_1 \cos(2\pi f t) + \beta_2 \sin(2\pi f t)}

The noise AR order is selected by AIC from 0 to \code{max_p}.
}
\examples{
# Linear trend plus AR noise
set.seed(123)
t <- 1:100
signal <- 5 + 0.1 * t
noise <- arima.sim(model = list(ar = 0.7), n = 100)
x <- signal + noise

result <- fore_sigplusnoise(x, linear = TRUE, n_ahead = 10)

# Cosine signal plus noise
signal2 <- 10 + 3 * cos(2 * pi * 0.1 * t)
x2 <- signal2 + noise

result2 <- fore_sigplusnoise(x2, linear = FALSE, freq = 0.1, n_ahead = 10)

}
\seealso{
\code{\link[=gen_sigplusnoise]{gen_sigplusnoise()}} for generating signal plus noise data,
\code{\link[=fore_arma]{fore_arma()}} for ARMA forecasting.
}
