% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/factor_comp.R
\name{factor_comp}
\alias{factor_comp}
\title{Factor Component Decomposition of a Time Series}
\usage{
factor_comp(x, p, n_comp, aic = FALSE, plot = TRUE)
}
\arguments{
\item{x}{Numeric vector. The time series to decompose.}

\item{p}{Integer. The AR order to fit. If \code{aic = TRUE}, this is the maximum
order to consider.}

\item{n_comp}{Integer. Number of components to extract. If greater than the
number of factors, it will be reduced to the number of factors.}

\item{aic}{Logical. If \code{TRUE}, select AR order by AIC up to \code{p}. If \code{FALSE}
(default), use exactly order \code{p}.}

\item{plot}{Logical. If \code{TRUE} (default), plot the original series and
extracted components.}
}
\value{
A list with class \code{"factor_comp"} containing:
\item{n_comp}{Number of components extracted.}
\item{n_factors}{Total number of factors in the AR model.}
\item{components}{Matrix of dimension \verb{(n_comp, n)} with each row being
a component series. Values before index \code{p} are zero.}
\item{phi}{AR coefficients from the fitted model.}
\item{roots}{Complex roots of the AR polynomial, sorted by absolute value.}
\item{factors}{Factor table from \code{\link[=factor]{factor()}} showing the AR factors.}
}
\description{
Decomposes a time series into components based on the factors of a fitted
AR model using partial fraction decomposition.
}
\details{
The function works by:
\enumerate{
\item Fitting an AR(p) model using Burg's method (\code{\link[stats:ar]{stats::ar.burg()}})
\item Finding the roots of the AR characteristic polynomial
\item Using partial fraction decomposition to determine how each factor
contributes to the overall model
\item Computing each component's contribution to the original series
}

For an AR polynomial with roots \eqn{r_1, r_2, \ldots, r_p}, the transfer
function \eqn{1/\phi(B)} can be written as a sum of partial fractions.
Each factor (real root or complex conjugate pair) corresponds to one
component of the decomposition.

Complex conjugate pairs are combined into a single real-valued component,
so the number of factors is:
\deqn{n_{factors} = n_{real} + n_{complex pairs}}
}
\examples{
# Generate AR(4) with two factor pairs
set.seed(123)
# Two complex conjugate pairs at different frequencies
x <- gen_arma(n = 200, phi = c(1.2, -0.85, 0.4, -0.3), plot = FALSE)

# Decompose into 2 components
result <- factor_comp(x, p = 4, n_comp = 2)

# Access components
dim(result$components)

}
\seealso{
\code{\link[=factor]{factor()}} for displaying AR factors,
\code{\link[=est_ar]{est_ar()}} for AR model estimation.
}
