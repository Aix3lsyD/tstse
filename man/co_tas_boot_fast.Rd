% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/co_tas_boot_fast.R
\name{co_tas_boot_fast}
\alias{co_tas_boot_fast}
\title{Fast Bootstrap Cochrane-Orcutt Trend Test with Turner Adjusted Sample Size}
\usage{
co_tas_boot_fast(
  x,
  nb = 399L,
  maxp = 5L,
  type = c("aic", "aicc", "bic"),
  btest = FALSE,
  seed = NULL
)
}
\arguments{
\item{x}{A numeric vector containing the time series data.}

\item{nb}{Number of bootstrap replicates. Default is 399.}

\item{maxp}{Maximum AR order for model selection. Default is 5.}

\item{type}{Character. Information criterion for order selection:
\code{"aic"}, \code{"aicc"}, or \code{"bic"}. Default is \code{"aic"}.}

\item{btest}{Logical. If \code{FALSE} (default), bootstrap using p-values.
If \code{TRUE}, bootstrap using t-statistics (comparing absolute values).}

\item{seed}{Optional integer seed for reproducibility. Default is NULL.}
}
\value{
A list with class \code{"co_tas_boot"} containing:
\item{pvalue}{Bootstrap p-value for test of H0: no trend.}
\item{tco}{t-statistic from the original data.}
\item{pvalue_asymptotic}{Asymptotic p-value from \code{\link[=co_tas_fast]{co_tas_fast()}}.}
\item{phi}{AR coefficients from the CO-TAS fit (differenced series model).}
\item{phi_null}{AR coefficients from null model (fit to original data).}
\item{vara}{Innovation variance from null model.}
\item{nb}{Number of bootstrap replicates used.}
\item{btest}{Logical indicating which bootstrap method was used.}
\item{boot_pvals}{Vector of bootstrap p-values (if \code{btest=FALSE}).}
\item{boot_tco}{Vector of bootstrap t-statistics (if \code{btest=TRUE}).}
\item{boot_seeds}{Vector of RNG seeds used for each bootstrap replicate.}
}
\description{
High-performance bootstrap version of the Cochrane-Orcutt trend test with
Turner adjusted sample size. Uses C++ parallelization via TBB for
approximately 30-50x speedup over \code{\link[=co_tas_boot]{co_tas_boot()}}.
}
\details{
This is a high-performance C++ implementation of \code{\link[=co_tas_boot]{co_tas_boot()}},
optimized for large-scale applications. Key differences:

\itemize{
\item Parallelization via TBB (works on all platforms)
\item All bootstrap iterations run in C++ (no R overhead)
\item Thread-safe RNG (dqrng with xoshiro256+)
}

Expected speedup is 30-50x compared to \code{\link[=co_tas_boot]{co_tas_boot()}} depending on
series length and number of available CPU cores.

The bootstrap procedure:
\enumerate{
\item Fit \code{\link[=co_tas_fast]{co_tas_fast()}} to the original data to obtain the test statistic
\item Fit AR(p) model directly to the original data for the null model
\item Generate \code{nb} bootstrap series from AR(phi_null) with no trend in parallel
\item For each bootstrap series:
\itemize{
\item If \code{btest=FALSE}: compute p-value using C++ CO-TAS
\item If \code{btest=TRUE}: compute t-statistic using C++ CO-TAS
}
\item Compute bootstrap p-value:
\itemize{
\item If \code{btest=FALSE}: proportion of bootstrap p-values <= observed
\item If \code{btest=TRUE}: proportion with |t| >= |observed t|
}
}

The t-statistic bootstrap (\code{btest=TRUE}) can be more powerful when the
null distribution of p-values is not uniform.

\strong{Performance Tuning:}
For optimal parallel performance, you may want to disable BLAS multi-threading
to avoid nested parallelism. See \code{\link[=wbg_boot_fast]{wbg_boot_fast()}} for details.

\strong{Reproducibility:}
Results are exactly reproducible given the same \code{seed}, platform, compiler,
and math library. Minor platform differences may occur (see \code{\link[=wbg_boot_fast]{wbg_boot_fast()}}).
}
\examples{
\donttest{
# Generate series with trend and AR(1) errors
set.seed(123)
n <- 100
t <- 1:n
z <- arima.sim(list(ar = 0.7), n = n)
x <- 5 + 0.1 * t + z

# Fast bootstrap trend test using p-values (default)
result <- co_tas_boot_fast(x, nb = 199, seed = 42)
print(result)

# Fast bootstrap using t-statistics
result_t <- co_tas_boot_fast(x, nb = 199, btest = TRUE, seed = 42)
print(result_t)
}

\dontrun{
# Benchmark comparison
library(microbenchmark)
x <- arima.sim(list(ar = 0.7), n = 100)
microbenchmark(
  fast = co_tas_boot_fast(x, nb = 199, seed = 42),
  original = co_tas_boot(x, nb = 199, seed = 42),
  times = 5
)
}

}
\references{
Turner, J. R. (1988). Effective sample size: A frequently neglected concept.
\emph{Journal of Educational Statistics}, 13(2), 175-181.

Woodward, W. A., Gray, H. L., and Elliott, A. C. (2017).
\emph{Applied Time Series Analysis with R}. CRC Press.
}
\seealso{
\code{\link[=co_tas_boot]{co_tas_boot()}} for the R implementation,
\code{\link[=co_tas_fast]{co_tas_fast()}} for single-run fast version,
\code{\link[=wbg_boot_fast]{wbg_boot_fast()}} for WBG bootstrap trend test
}
