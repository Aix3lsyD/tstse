% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/ar_mle.R
\name{aic_ar_mle}
\alias{aic_ar_mle}
\title{Fit AR Model via MLE with Information Criterion Selection}
\usage{
aic_ar_mle(
  x,
  p_max,
  criterion = c("aic", "aicc", "bic"),
  stationary = TRUE,
  n_best = 3L,
  tol = 1.001,
  silent = TRUE
)
}
\arguments{
\item{x}{Numeric vector. The time series to fit.}

\item{p_max}{Integer. Maximum AR order to consider. Can also be a vector
of orders to try (e.g., 1:5).}

\item{criterion}{Character. Information criterion for model selection:
\code{"aic"} (default), \code{"aicc"} (corrected AIC), or \code{"bic"}.}

\item{stationary}{Logical. If TRUE (default), check that the selected model
is stationary and fall back to next best if not. If FALSE, return the
best model by criterion regardless of stationarity.}

\item{n_best}{Integer. Number of top models (by criterion) to check for
stationarity before failing. Ignored if \code{stationary = FALSE}.
Default is 3.}

\item{tol}{Numeric. Tolerance for stationarity check (roots must have
modulus > tol). Ignored if \code{stationary = FALSE}. Default is 1.001.}

\item{silent}{Logical. If TRUE (default), suppress convergence warnings
from \code{arima()}.}
}
\value{
A list containing:
\item{phi}{Numeric vector of AR coefficients.}
\item{p}{Integer. The selected AR order.}
\item{criterion_value}{The value of the selection criterion.}
\item{method_used}{Character. Always \code{"mle"} for this function.}
\item{all_criteria}{Named numeric vector of criterion values for all
successfully fit orders.}
}
\description{
Fits AR models of orders 1 through p_max using maximum likelihood
estimation, selects the best model according to the specified information
criterion. Optionally verifies stationarity and falls back through top
candidates if the best model is non-stationary.
}
\details{
The function attempts to fit AR(p) models for each order using
\code{arima()} with \code{method = "CSS-ML"} (conditional sum of squares
initialization followed by MLE refinement).

Models are ranked by the specified criterion. If \code{stationary = TRUE},
the function checks the top \code{n_best} models for stationarity and
returns the best stationary model. If no stationary model is found among
the top candidates, an error is raised.

If \code{stationary = FALSE}, the best model by criterion is returned
regardless of whether it is stationary. This can be useful for
simulation studies.
}
\examples{
# Simulate AR(2) data
set.seed(123)
x <- arima.sim(list(ar = c(0.7, 0.2)), n = 200)

# Fit with AIC selection
fit <- aic_ar_mle(x, p_max = 5)
fit$p    # Selected order
fit$phi  # Coefficients

# Fit with BIC selection (tends to select simpler models)
fit_bic <- aic_ar_mle(x, p_max = 5, criterion = "bic")

# Allow non-stationary estimates (for simulation studies)
fit_free <- aic_ar_mle(x, p_max = 5, stationary = FALSE)

}
\seealso{
\code{\link[=check_stationary]{check_stationary()}}, \code{\link[=aic_burg]{aic_burg()}} for Burg estimation
(always stationary), \code{\link[=aic_ar]{aic_ar()}} for order selection with different methods.
}
